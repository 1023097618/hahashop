"use strict";(self["webpackChunkhahashop"]=self["webpackChunkhahashop"]||[]).push([[529],{4959:function(e,t,r){r.d(t,{A:function(){return c}});var o=function(){var e=this,t=e._self._c;return t("div",[e.error?t("el-result",{attrs:{title:"404",subTitle:"抱歉，请求错误"}},[t("template",{slot:"icon"},[t("el-image",{attrs:{src:"https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"}})],1)],2):e._e()],1)},a=[],s={name:"webErrorResult",props:{error:{type:Boolean,required:!0}}},i=s,l=r(1656),n=(0,l.A)(i,o,a,!1,null,null,null),c=n.exports},2529:function(e,t,r){r.r(t),r.d(t,{default:function(){return I}});var o=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"layoutview"}},[t("el-container",[t("el-header",{staticStyle:{height:"60px"}},[t("el-row",{staticClass:"row-bg",staticStyle:{"align-items":"center",height:"100%"},attrs:{type:"flex",justify:"space-around"}},[t("el-col",{attrs:{span:6}}),t("el-col",{staticStyle:{"text-align":"center"},attrs:{span:8}},[t("h1",[e._v("hahashop")])]),t("el-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.login()}}},[e._v("登录")])],1)],1)],1),t("el-main",[t("SearchInput",{staticClass:"search",on:{search:e.search}}),t("div",{staticClass:"category"},[t("span",{staticClass:"demonstration"},[e._v("类别选择")]),t("el-cascader",{attrs:{options:e.options,props:{expandTrigger:"hover"},clearable:""},on:{change:e.handleChange},model:{value:e.category,callback:function(t){e.category=t},expression:"category"}})],1),t("el-skeleton",{attrs:{rows:3,animated:"",loading:e.isload}}),t("webErrorResult",{attrs:{error:e.weberror}}),e.isload||e.weberror?e._e():t("div",[e._l(e.productRows,(function(r,o){return t("el-row",{key:o,attrs:{gutter:20}},e._l(r,(function(r){return t("el-col",{key:r.goodId,attrs:{span:6}},[t("ProductCard",{attrs:{product:r},on:{Userclick:function(t){return e.buy(r)}}})],1)})),1)})),e.totalProducts>e.pageSize?t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"prev, pager, next",total:e.totalProducts},on:{"current-change":e.handlePageChange}}):e._e()],2)],1)],1),t("PurchaseDialog",{ref:"purchaseDialog",attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}})],1)},a=[],s=(r(4114),function(){var e=this,t=e._self._c;return t("el-card",{class:{frozen:e.product.goodNum<=0,active:e.product.goodNum>0,clicked:e.clicked},attrs:{"body-style":{padding:"0px"}}},[t("div",{staticClass:"image-container",on:{click:e.handleClick}},[t("el-carousel",{attrs:{trigger:"click",height:"150px",autoplay:!1,"indicator-position":"none"}},e._l(e.product.goodImage,(function(e,r){return t("el-carousel-item",{key:r},[t("img",{staticClass:"image",attrs:{src:e}})])})),1)],1),t("div",{staticStyle:{padding:"14px","line-height":"13px"},on:{click:e.handleClick}},[t("span",[e._v(e._s(e.product.goodName))]),t("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[t("time",{staticClass:"time"},[e._v(e._s(e.product.goodPrice))]),t("time",{staticClass:"time"},[e._v("剩余库存:"+e._s(e.product.goodNum))])])])])}),i=[],l={props:{product:{type:Object,required:!0}},data(){return{clicked:!1}},methods:{handleClick(){this.$emit("Userclick"),this.product.goodNum>0&&(this.clicked=!0,setTimeout((()=>{this.clicked=!1}),500))}}},n=l,c=r(1656),u=(0,c.A)(n,s,i,!1,null,"46626633",null),d=u.exports,h=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"买家信息填写",visible:this.visible,width:"30%","before-close":e.closeDialog}},[t("div",{staticStyle:{"text-align":"center"}},[e._v("商品名:"+e._s(e.product.goodName))]),t("div",{staticStyle:{"text-align":"center"}},[e._v("商品价格:"+e._s(e.product.goodPrice))]),t("div",{staticStyle:{"text-align":"center"}},[e._v("商品描述："),t("div",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:e.product.goodDesc,expression:"product.goodDesc"}],staticClass:"rich-text-content"})]),t("el-form",{attrs:{model:e.form,"label-position":"right","label-width":"80px"}},[t("el-form-item",{attrs:{label:"姓名"}},[t("el-input",{model:{value:e.form.buyerRealName,callback:function(t){e.$set(e.form,"buyerRealName",t)},expression:"form.buyerRealName"}})],1),t("el-form-item",{attrs:{label:"手机号"}},[t("el-input",{model:{value:e.form.buyerPhone,callback:function(t){e.$set(e.form,"buyerPhone",t)},expression:"form.buyerPhone"}})],1),t("el-form-item",{attrs:{label:"交易地点"}},[t("el-input",{model:{value:e.form.buyerAddress,callback:function(t){e.$set(e.form,"buyerAddress",t)},expression:"form.buyerAddress"}})],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.buyerDesc,callback:function(t){e.$set(e.form,"buyerDesc",t)},expression:"form.buyerDesc"}})],1),t("el-form-item",{attrs:{label:"购买数量"}},[t("el-input-number",{attrs:{min:1,max:10,label:"描述文字"},on:{change:e.handleChange},model:{value:e.form.buyerGoodsNum,callback:function(t){e.$set(e.form,"buyerGoodsNum",t)},expression:"form.buyerGoodsNum"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.closeDialog()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sureDialog()}}},[e._v("确 定")])],1)],1)},p=[],g=r(6551),m=r(79),f={data(){return{form:{buyerRealName:"",buyerPhone:"",buyerAddress:"",buyerDesc:"",buyerGoodsNum:1},product:{goodDesc:"",goodPrice:"",goodName:"",goodImage:""}}},props:{visible:{type:Boolean,required:!0}},methods:{openDialog(e,t){Object.assign(this.product,e),this.form.buyerRealName=t.userRealName,this.form.buyerPhone=t.userPhone,this.form.buyerAddress=t.userAddress,this.$emit("update:visible",!0),(0,g._P)(this.product.goodId).then((e=>{this.product.goodDesc=e.data.data.goodDesc,console.log(this.product.goodDesc)})).catch((e=>{console.log(e)}))},closeDialog(){this.$emit("update:visible",!1)},sureDialog(){this.$emit("update:visible",!1),(0,m.HW)({...this.form,goodId:this.product.goodId}).then((e=>{console.log(e)})).catch((e=>{console.log(e)}))},handleChange(e){this.form.buyerGoodsNum=e}}},y=f,b=(0,c.A)(y,h,p,!1,null,null,null),v=b.exports,k=r(4959),_=r(3603),x=function(){var e=this,t=e._self._c;return t("div",[t("el-input",{staticStyle:{width:"350px","margin-right":"10px"},attrs:{disabled:!1,placeholder:e.placeholder,"prefix-icon":"el-icon-search",clearable:""},on:{clear:e.search},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("el-button",{attrs:{disabled:!1,icon:"el-icon-search",type:"primary"},on:{click:e.search}},[e._v(" 搜索 ")])],1)},w=[],P={name:"SearchInput",props:{disabled:{type:Boolean,default:!0},placeholder:{type:String,default:"请输入昵称进行搜索，可以直接回车搜索..."}},data(){return{keyword:""}},methods:{search(){this.$emit("search",this.keyword)}}},A=P,D=(0,c.A)(A,x,w,!1,null,"4c1e61ef",null),C=D.exports,N={components:{ProductCard:d,PurchaseDialog:v,webErrorResult:k.A,SearchInput:C},data(){return{products:[],totalProducts:0,currentPage:1,pageSize:8,dialogVisible:!1,isload:!0,weberror:!1,keyword:"",category:[],options:[{children:[{label:"布艺软装",value:1008002}],label:"居家",value:1005e3}]}},methods:{fetchProducts(){this.isload=!0;const e={pageNum:this.currentPage,pageSize:this.pageSize};this.keyword&&(e.goodName=this.keyword),0!==this.category.length&&(e.category=JSON.stringify(this.category)),(0,g.HI)(e).then((e=>{console.log(e),this.products=e.data.data.goods,this.totalProducts=e.data.data.totalGoods,this.isload=!1,this.weberror=!1})).catch((e=>{this.isload=!1,this.weberror=!0,console.error("Error fetching products:",e)}))},handlePageChange(e){this.currentPage=e,this.fetchProducts()},login(){this.$router.push("/login").catch((e=>{console.log(e)}))},buy(e){if(e.goodNum<=0)return;const t=(0,_.VY)();if(t)if(0===this.$store.getters.permmited){const r=this.$store.getters.user;this.$store.dispatch("GetUserInfoAction",t).then((()=>{this.$refs.purchaseDialog.openDialog(e,r)})).catch((e=>{console.log(e),(0,_.TK)(),this.login()}))}else{const t=this.$store.getters.user;this.$refs.purchaseDialog.openDialog(e,t)}else this.login()},search(e){this.keyword=e,this.fetchProducts()},Getcategoty(){(0,g.p7)().then((e=>{this.options=e.data.data.categoryList}))},handleChange(e){this.category=e,this.fetchProducts()}},computed:{productRows(){const e=[];for(let t=0;t<this.products.length;t+=4)e.push(this.products.slice(t,t+4));return console.log(e),e}},created(){this.fetchProducts(),this.Getcategoty()}},S=N,$=(0,c.A)(S,o,a,!1,null,"3235179c",null),I=$.exports},79:function(e,t,r){r.d(t,{Dm:function(){return n},HW:function(){return a},Ii:function(){return l},WF:function(){return s},iD:function(){return i}});var o=r(5720);function a(e){return(0,o.A)({url:"/order/buy",method:"post",data:e})}function s(e){return(0,o.A)({url:"/order/sellerlist",method:"get",params:e})}function i(e){return(0,o.A)({url:"/order/confirmsell",method:"post",data:e})}function l(e){return(0,o.A)({url:"/order/cancelsell",method:"post",data:e})}function n(e){return(0,o.A)({url:"/order/buyerlist",method:"get",params:e})}},6551:function(e,t,r){r.d(t,{HI:function(){return a},JH:function(){return l},OZ:function(){return n},_P:function(){return s},iJ:function(){return i},p7:function(){return c}});var o=r(5720);function a(e){return(0,o.A)({url:"/good/list",params:e,method:"get"})}function s(e){return(0,o.A)({url:"/good/detail",method:"get",params:{id:e}})}function i(e){return(0,o.A)({url:"/good/update",data:e,method:"update"})}function l(e){return(0,o.A)({url:"/good/delete",data:{goodId:e},method:"delete"})}function n(e){return(0,o.A)({url:"/good/add",data:e,method:"post"})}function c(){return(0,o.A)({url:"/good/category",method:"get"})}}}]);
//# sourceMappingURL=529.a1c8fa51.js.map